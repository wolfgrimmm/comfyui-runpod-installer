# Minimal working RunPod image
FROM runpod/pytorch:2.1.0-py3.10-cuda12.1.0-devel-ubuntu22.04

WORKDIR /workspace

# Install ComfyUI
RUN git clone https://github.com/comfyanonymous/ComfyUI.git && \
    cd ComfyUI && \
    pip install -r requirements.txt

# Create start script
RUN echo '#!/bin/bash' > /start.sh && \
    echo 'cd /workspace/ComfyUI && python main.py --listen 0.0.0.0 --port 8188' >> /start.sh && \
    chmod +x /start.sh

EXPOSE 8188

# This is what RunPod expects
CMD ["/start.sh"]